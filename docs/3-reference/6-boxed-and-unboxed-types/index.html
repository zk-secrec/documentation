<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Boxed and Unboxed Types - The ZK-SecreC Language Documentation</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../../css/typesystem.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">The ZK-SecreC Language Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">User Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../1-user-guide/0-installation/" class="dropdown-item">Installation</a>
</li>
                                    
<li>
    <a href="../../1-user-guide/1-getting-started/" class="dropdown-item">Getting Started</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Developer Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../2-dev-guide/0-profiling/" class="dropdown-item">Profiling</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Reference</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../0-values-and-types/" class="dropdown-item">Values and Types</a>
</li>
                                    
<li>
    <a href="../1-lexical-structure/" class="dropdown-item">Lexical Structure</a>
</li>
                                    
<li>
    <a href="../2-type-level-expressions/" class="dropdown-item">Type Level Expressions</a>
</li>
                                    
<li>
    <a href="../3-expressions/" class="dropdown-item">Expressions</a>
</li>
                                    
<li>
    <a href="../4-top-level/" class="dropdown-item">Top Level</a>
</li>
                                    
<li>
    <a href="../5-type-system/" class="dropdown-item">Type System</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Boxed and Unboxed Types</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">API</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../4-api/BigInt/" class="dropdown-item">BigInt</a>
</li>
                                    
<li>
    <a href="../../4-api/Bitextract/" class="dropdown-item">Bitextract</a>
</li>
                                    
<li>
    <a href="../../4-api/Builtin/" class="dropdown-item">Builtin</a>
</li>
                                    
<li>
    <a href="../../4-api/Char/" class="dropdown-item">Char</a>
</li>
                                    
<li>
    <a href="../../4-api/ChrVec/" class="dropdown-item">CheVec</a>
</li>
                                    
<li>
    <a href="../../4-api/Date/" class="dropdown-item">Date</a>
</li>
                                    
<li>
    <a href="../../4-api/DFA/" class="dropdown-item">DFA</a>
</li>
                                    
<li>
    <a href="../../4-api/EC/" class="dropdown-item">EC</a>
</li>
                                    
<li>
    <a href="../../4-api/FastFixedPoint/" class="dropdown-item">FastFixedPoint</a>
</li>
                                    
<li>
    <a href="../../4-api/FastFixedPointVec/" class="dropdown-item">FastFixedPointVec</a>
</li>
                                    
<li>
    <a href="../../4-api/FixedPoint/" class="dropdown-item">FixedPoint</a>
</li>
                                    
<li>
    <a href="../../4-api/Inequalities/" class="dropdown-item">Inequalities</a>
</li>
                                    
<li>
    <a href="../../4-api/Integer/" class="dropdown-item">Integer</a>
</li>
                                    
<li>
    <a href="../../4-api/IsFromFirst/" class="dropdown-item">IsFromFirst</a>
</li>
                                    
<li>
    <a href="../../4-api/OldInequalities/" class="dropdown-item">OldInequalities</a>
</li>
                                    
<li>
    <a href="../../4-api/Perm/" class="dropdown-item">Perm</a>
</li>
                                    
<li>
    <a href="../../4-api/Poseidon/" class="dropdown-item">Poseidon</a>
</li>
                                    
<li>
    <a href="../../4-api/Prob/" class="dropdown-item">Prob</a>
</li>
                                    
<li>
    <a href="../../4-api/SetOp/" class="dropdown-item">SetOp</a>
</li>
                                    
<li>
    <a href="../../4-api/Std/" class="dropdown-item">Std</a>
</li>
                                    
<li>
    <a href="../../4-api/Store/" class="dropdown-item">Store</a>
</li>
                                    
<li>
    <a href="../../4-api/StoreVec/" class="dropdown-item">StoreVec</a>
</li>
                                    
<li>
    <a href="../../4-api/String/" class="dropdown-item">String</a>
</li>
                                    
<li>
    <a href="../../4-api/Text/" class="dropdown-item">Text</a>
</li>
                                    
<li>
    <a href="../../4-api/Vec/" class="dropdown-item">Vec</a>
</li>
                                    
<li>
    <a href="../../4-api/Waksman/" class="dropdown-item">Waksman</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Backend Interface</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../5-backend-interface/0-interfacing-a-new-backend/" class="dropdown-item">Interfacing a New Backend</a>
</li>
                                    
<li>
    <a href="../../5-backend-interface/1-trait-methods/" class="dropdown-item">Trait Methods</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../5-type-system/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../4-api/BigInt/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#boxed-and-unboxed-types" class="nav-link">Boxed and unboxed types</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#primitive-types" class="nav-link">Primitive Types</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#vectors-and-lists" class="nav-link">Vectors and lists</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="boxed-and-unboxed-types">Boxed and unboxed types</h1>
<h2 id="primitive-types">Primitive Types</h2>
<p>Values of most types in ZK-SecreC are reference counted, making them cheap to clone by just increasing the reference count instead of making a deep copy of the data structure. However, for basic integers and booleans in the <code>$pre</code> domain, the overhead of reference counting is much larger than the cost of actually doing arithmetic or boolean operations on them, making those operations up to 2 orders of magnitude slower than they are in Rust. For this reason, integers of the types <code>uint[</code>2<sup><em>n</em></sup><code>]</code> where <em>n</em>=8,16,32,64,128 are compiled to integers of Rust types <code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code> and <code>u128</code>, respectively. These types, as well as all boolean types, do not have reference counting. Arithmetic, boolean, and comparison operations on them have speeds close to those of the corresponding operations in Rust.</p>
<p>Primitive types can be domain polymorphic or have a fixed domain (e.g. <code>@prover</code>). The types must be known to be in the <code>$pre</code> stage at compile time. If they are stage polymorphic then they will be reference counted even if they are in the <code>$pre</code> stage during run time. Booleans can also be polymorphic in the modulus but integers must have the modulus known at compile time, otherwise they will be reference counted.</p>
<p>The following operations on primitive types have speed close to the corresponding operations in Rust:</p>
<ul>
<li>Arithmetic operations <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></li>
<li>Comparison operations <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code></li>
<li>Boolean operations <code>&amp;</code>, <code>|</code>, <code>xor</code>, <code>!</code></li>
</ul>
<h2 id="vectors-and-lists">Vectors and lists</h2>
<p>In this section the term <em>array</em> is used to include both ZK-SecreC vectors (<code>arr[...]</code>) and lists (<code>list[...]</code>).</p>
<p>Arrays in ZK-SecreC can be internally boxed or unboxed, although there is no difference in the type of the array. Boxed arrays have each element separately reference counted, causing much more overhead when accessing the elements. The elements of boxed arrays can be of non-primitive or primitive type. Unboxed arrays do not have each element separately reference counted and the elements can only be of primitive type. All primitive types can be used as elements of unboxed arrays. Both boxed and unboxed arrays as a whole (as opposed to their individual elements) are always reference counted.</p>
<p>If an array is created and its element type is known to be primitive at compile time then the array will automatically be unboxed. If the element type is not known to be primitive at compile time (e.g., in polymorphic functions) then the array will be boxed, even if the element type will actually be primitive during run time.</p>
<p>Boxed and unboxed arrays can be used interchangeably in ZK-SecreC native code, i.e., an unboxed array can be given as an argument to a polymorphic function that expects a boxed array and a boxed array of primitive values returned from a polymorphic function can be used in a non-polymorphic code that expects an unboxed array. Whole arrays are not automatically converted from boxed to unboxed type or vice versa. Instead, individual elements of the array are converted between reference counted and primitive types as needed. This can cause some extra overhead. A for loop can be used to make a copy of an array with optimal boxedness for the current scope.</p>
<p>However, boxed arrays of primitive types cannot be passed to foreign functions.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
